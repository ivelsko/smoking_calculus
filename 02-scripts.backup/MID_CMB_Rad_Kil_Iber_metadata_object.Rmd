---
title: "MID/CMB, Radcliffe, Kilteasheen, Iberian medieval calculus metadata and colors"
author: "Irina Velsko"
date: "`r format(Sys.time(), '%b %d, %Y')`"
output:
    github_document:
        fig_width: 8
        fig_height: 6
        toc: true
---

```{r load_libraries, echo = F, message = F}
library(knitr)
library(data.table)
library(tidyverse)

```

```{r setup}
knitr::opts_knit$set(root.dir = normalizePath(".."))
```

This creates an RData object that has the full metadata table, where the columns
we use for plotting are set as factors, and lists the colors, shapes, and sizes of
points for plotting PCAs and such for each of the metadata categories we're
interested in.
```{r metadata}
# load the metadata file
full_metadata <- fread("./00-documentation.backup/radcliffe_pfuT_metadata.tsv") %>%
  bind_rows(., fread("./00-documentation.backup/iberian_medieval_metadata.tsv")) %>%
  bind_rows(., fread("./00-documentation.backup/kilteasheen_metadata.tsv")) %>%
  full_join(., fread("./00-documentation.backup/MID_analysis_metadata.tsv"))


full_metadata <- full_metadata %>%
  as_tibble() %>%
  # remove the MID samples that have no metadata
  filter(!str_detect(Library_ID, "MID025.A0101|MID033.A0101|MID056.A0101|MID065.A0101|MID068.A0101|MID076.A0101|MID078.A0101")) %>%
  mutate(Site = fct_relevel(Site, "Middenbeemster", "CMB", "Radcliffe", "Kilteasheen",
                                   "ELR", "IVE","Extraction_blank","Library_blank"),
         Time_period = fct_relevel(Time_period, "Industrial","Medieval","Extraction_blank","Library_blank"),
         Region = fct_relevel(Region, "Netherlands","Spain","England", "Ireland","Iberia"),
         Periodontal_disease_present = fct_relevel(Periodontal_disease_present, "Yes","No","Unobservable"),
         Caries_present = fct_relevel(Caries_present, "Yes","No","Unobservable"),
         Sample_or_Control = fct_relevel(Sample_or_Control, "Sample","Control"),
         Sex = fct_relevel(Sex, "Female","Male","Indeterminate"),
         Tooth_location = fct_relevel(Tooth_location, "Anterior","Anterior/Posterior","Posterior","Unknown"),
         alt_tooth_location = fct_relevel(alt_tooth_location, "Anterior","Anterior/Posterior","Posterior","Unknown"))

```

```{r colors}
# lacroix_palette("PeachPear", n = 8, type = "continuous")
# "#FF3200" "#EF8158" "#E9BD8E" "#CBDDA7" "#38BCAD" "#0B91B5" "#065FA3" "#172869"

Site_colors <- c(Middenbeemster = "#311068", CMB = "#5A167E", Radcliffe = "#C83E73", Kilteasheen = "#E95562", ELR = "#FEA873",
                      IVE = "#FED395", Extraction_blank = "#252525", Library_blank = "#737373")
Site_shapes <- c(Middenbeemster = 15, CMB = 16, Radcliffe = 17, Kilteasheen = 18, ELR = 25, IVE = 14, Extraction_blank = 4, Library_blank = 3)
Site_size <- c(Middenbeemster = 4.5, CMB = 4, Radcliffe = 4, Kilteasheen = 6, ELR = 4, IVE = 4, Extraction_blank = 4, Library_blank = 4)

Time_period_colors <- c(Industrial = "#311068", Medieval = "#C83E73", Extraction_blank = "#252525", Library_blank = "#737373")
Time_period_shapes <- c(Industrial = 19, Medieval = 17, Extraction_blank = 4, Library_blank = 3)
Time_period_size <- c(Industrial = 4, Medieval = 4,  Extraction_blank = 4, Library_blank = 4)

Region_colors <- c(Netherlands = "#311068", Spain = "#5A167E", England = "#C83E73", Iberia = "#FEA873", Ireland = "#E95562",
                Extraction_blank = "#252525", Library_blank = "#737373")
Region_shapes <- c(Netherlands = 9, Spain = 12, England = 10, Iberia = 7, Ireland = 13, Extraction_blank = 4, Library_blank = 3)
Region_size <- c(Netherlands = 4, Spain = 4, England = 4, Iberia = 4, Ireland = 4, Extraction_blank = 4, Library_blank = 4)

Periodontal_disease_present_colors <- c(Yes = "#311068", No = "#C83E73", Unobservable = "#737373")
Periodontal_disease_present_shapes <- c(Yes = 19, No = 14, Unobservable = 10)
Periodontal_disease_present_size <- c(Yes = 4, No = 4, Unobservable = 4)

Sample_or_Control_colors <- c(Sample = "#311068", Control = "#737373")
Sample_or_Control_shapes <- c(Sample = 19, Control = 8)
Sample_or_Control_size <- c(Sample = 4, Control = 4)

Caries_present_colors <- c(Yes = "#311068", No = "#C83E73", Unobservable = "#737373")
Caries_present_shapes <- c(Yes = 19, No = 14, Unobservable = 10)
Caries_present_size <- c(Yes = 4, No = 4, Unobservable = 4)

Sex_colors <- c(Female = "#311068", Male = "#C83E73", Indeterminate = "#737373")
Sex_shapes <- c(Female = 19, Male = 17, Indeterminate = 8)
Sex_size <- c(Female = 4, Male = 4, Indeterminate = 4)

Tooth_location_colors <- c(Anterior = "#311068", `Anterior/Posterior` = "#C83E73", Posterior = "#FEA873", Unknown = "#737373")
Tooth_location_shapes <- c(Anterior = 19, `Anterior/Posterior` = 18, Posterior = 17, Unknown = 8)
Tooth_location_size <- c(Anterior = 4, `Anterior/Posterior` = 4.5, Posterior = 4, Unknown = 4)

alt_tooth_location_colors <- c(Anterior = "#311068", `Anterior/Posterior` = "#C83E73", Posterior = "#FEA873", Unknown = "#737373")
alt_tooth_location_shapes <- c(Anterior = 19, `Anterior/Posterior` = 18, Posterior = 17, Unknown = 8)
alt_tooth_location_size <- c(Anterior = 4, `Anterior/Posterior` = 4.5, Posterior = 4, Unknown = 4)

```


```{r save_data}
save(full_metadata, 
     Site_colors, Site_shapes, Site_size,
     Time_period_colors, Time_period_shapes, Time_period_size,
     Region_colors, Region_shapes, Region_size,
     Periodontal_disease_present_colors, Periodontal_disease_present_shapes, Periodontal_disease_present_size,
     Caries_present_colors, Caries_present_shapes, Caries_present_size, 
     Sample_or_Control_colors, Sample_or_Control_shapes, Sample_or_Control_size, 
     Sex_colors, Sex_shapes, Sex_size, 
     Tooth_location_colors,Tooth_location_shapes,Tooth_location_size,
     alt_tooth_location_colors,alt_tooth_location_shapes,alt_tooth_location_size,
     file = "./05-results.backup/Metadata_tables.RData")

```

