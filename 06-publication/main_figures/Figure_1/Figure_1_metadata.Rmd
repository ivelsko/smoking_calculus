---
title: "Smoking calculus metadata graphs"
author: "Irina Velsko"
date: "`r format(Sys.time(), '%b %d, %Y')`"
output:
    github_document:
        fig_width: 8
        fig_height: 6
        toc: true
---

```{r load_libraries, echo = F, message = F}
library(knitr)
library(data.table)
library(microshades)
library(tidyverse)
library(patchwork)

```

```{r setup}
knitr::opts_knit$set(root.dir = normalizePath("../../../"))
```

```{r load_metadata}

load("./05-results.backup/Metadata_tables.RData")
```


```{r smoking_pd}

smpd <- full_metadata %>%
  filter(str_detect(Library_ID, "MID")) %>%
  drop_na(Pipenotch) %>%
  ggplot(., aes(x = Pipenotch, y = Age, fill = Peridontal_affect_score, shape = Sex, size = `%AMTL`)) +
    ggpointgrid::geom_pointrect(scale_x = 0.10, scale_y = 0.22, color = "black", stroke = 0.5) +
    theme_minimal(base_size = 14) +
    scale_size_continuous(range = c(3,10)) +
    scale_shape_manual(values = c(21, 23, 22)) +
    scale_fill_gradient(low = "blue", high = "red") +
    # scale_color_manual(values = microshades_palette("micro_green")) +
    theme(axis.text = element_text(size = 14)) +
    xlab("Pipe notch(es)") +
    ylab("Age group")
smpd

# ggsave("./06-publication/main_figures/Figure_1/smpd.pdf", plot = smpd, device = "pdf",
#        scale = 1, width = 8, height = 5, units = c("in"), dpi = 300)

```

```{r smoking_caries}
smc <- full_metadata %>%
  filter(str_detect(Library_ID, "MID")) %>%
  drop_na(Pipenotch) %>%
  ggplot(., aes(x = Pipenotch, y = Age, fill = `%teeth_with_caries`, shape = Sex, size = `%AMTL`)) +
    ggpointgrid::geom_pointrect(scale_x = 0.10, scale_y = 0.22, color = "black", stroke = 0.5) +
    theme_minimal(base_size = 14) +
    scale_size_continuous(range = c(3,10)) +
    scale_shape_manual(values = c(21, 23, 22)) +
    scale_fill_gradient(low = "blue", high = "red") +
    theme(axis.text = element_text(size = 14)) +
    xlab("Pipe notch(es)") +
    ylab("Age group")
smc

# ggsave("./06-publication/main_figures/Figure_1/smc.pdf", plot = smc, device = "pdf",
#        scale = 1, width = 10, height = 7, units = c("in"), dpi = 300)

```

```{r smoking_calc_score}
smcs <- full_metadata %>%
  filter(str_detect(Library_ID, "MID")) %>%
  drop_na(Pipenotch) %>%
  ggplot(., aes(x = Pipenotch, y = Age, fill = Calc_sub_SI_score, shape = Sex, size = `%AMTL`)) +
    ggpointgrid::geom_pointrect(scale_x = 0.10, scale_y = 0.22, color = "black", stroke = 0.5) +
    theme_minimal(base_size = 14) +
    scale_size_continuous(range = c(3,10)) +
    scale_shape_manual(values = c(21, 23, 22)) +
    scale_fill_gradient(low = "blue", high = "red") +
    theme(axis.text = element_text(size = 14)) +
    xlab("Pipe notch(es)") +
    ylab("Age group")
smcs

# ggsave("./06-publication/main_figures/Figure_1/smcs.pdf", plot = smcs, device = "pdf",
#        scale = 1, width = 8, height = 5, units = c("in"), dpi = 300)

```

```{r plot_together}
metaplot <- smpd + smcs
metaplot

ggsave("./06-publication/main_figures/Figure_1/metaplot.pdf", plot = metaplot,
       device = "pdf", scale = 1, width = 21, height = 8, units = c("in"), dpi = 300)

```












